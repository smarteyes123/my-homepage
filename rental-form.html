<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>è³ƒè²¸ç‰©ä»¶ãŠå•ã„åˆã‚ã› | æ ªå¼ä¼šç¤¾ã‚¹ãƒãƒ¼ãƒˆã‚¢ã‚¤ã‚º</title>
  <meta name="description" content="è³ƒè²¸ç‰©ä»¶ã‚’ãŠæ¢ã—ã®æ–¹å‘ã‘ã®ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ ã€‚ã”å¸Œæœ›ã®æ¡ä»¶ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚" />
  <meta property="og:title" content="è³ƒè²¸ç‰©ä»¶ãŠå•ã„åˆã‚ã› | æ ªå¼ä¼šç¤¾ã‚¹ãƒãƒ¼ãƒˆã‚¢ã‚¤ã‚º" />
  <meta property="og:description" content="è³ƒè²¸ç‰©ä»¶ã‚’ãŠæ¢ã—ã®æ–¹å‘ã‘ã®ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ ã€‚ã”å¸Œæœ›ã®æ¡ä»¶ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.smarteyes.co.jp/rental-form.html" />
  <link rel="icon" href="logo.png" />
  <style>
    /* ===== Enhanced Color Palette ===== */
    :root{
      --brand:#1e40af;
      --brand-light:#3b82f6;
      --brand-ink:#0f172a;
      --gold:#f59e0b;
      --gold-light:#fbbf24;
      --ink:#0f172a;
      --ink-light:#334155;
      --muted:#64748b;
      --muted-light:#94a3b8;
      --bg:linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
      --bg-solid:#f8fafc;
      --card:#ffffff;
      --card-hover:#fefefe;
      --accent:#06b6d4;
      --accent-light:#67e8f9;
      --success:#10b981;
      --warning:#f59e0b;
      --error:#ef4444;
      --radius:16px;
      --shadow:0 4px 20px rgba(30, 64, 175, 0.08);
      --shadow-hover:0 10px 40px rgba(30, 64, 175, 0.15);
      --transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    html,body{margin:0;padding:0;background:var(--bg-solid);color:var(--ink);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,"Hiragino Kaku Gothic ProN","Hiragino Sans","Noto Sans JP","Microsoft YaHei",sans-serif;}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    .container{max-width:1200px;margin:0 auto;padding:0 20px}

    /* ===== Header & Navigation ===== */
    .site-header{position:sticky;top:0;z-index:50;background:rgba(255,255,255,0.95);backdrop-filter:blur(10px);border-bottom:1px solid #e2e8f0;transition:var(--transition)}
    .site-header .row{display:flex;align-items:center;justify-content:space-between;padding:14px 0;gap:12px}
    .brand{display:flex;align-items:center;gap:12px;transition:var(--transition)}
    .brand:hover{transform:translateY(-1px)}
    .brand img{height:48px;transition:var(--transition)}
    .brand .name{font-weight:700;letter-spacing:.2px;color:var(--brand-ink);background:linear-gradient(135deg, var(--brand), var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}

    /* ===== Language Dropdown ===== */
    .lang-dropdown{position:relative;display:inline-block}
    .lang-current{
      display:flex;align-items:center;gap:6px;
      border:1px solid #e2e8f0;background:linear-gradient(135deg, #ffffff, #f8fafc);
      padding:6px 10px;border-radius:8px;font-size:12px;
      cursor:pointer;transition:var(--transition);
      min-width:80px;min-height:36px;
      box-shadow:0 2px 8px rgba(30, 64, 175, 0.05);
    }
    .lang-current:hover{border-color:var(--brand-light);box-shadow:0 4px 12px rgba(30, 64, 175, 0.15);background:linear-gradient(135deg, #ffffff, #f1f5f9)}
    .lang-current:focus{outline:2px solid var(--brand);outline-offset:2px}
    .lang-current[aria-expanded="true"]{border-color:var(--brand);box-shadow:0 4px 12px rgba(30, 64, 175, 0.2)}
    .lang-current[aria-expanded="true"] .lang-arrow{transform:rotate(180deg)}
    .lang-icon{font-size:14px}
    .lang-text{flex:1;text-align:left;font-size:12px;color:var(--ink-light)}
    .lang-arrow{transition:transform 0.2s ease;font-size:8px;color:var(--muted)}
    .lang-menu{
      position:absolute;top:100%;left:0;right:0;
      background:linear-gradient(135deg, #ffffff, #f8fafc);border:1px solid #e2e8f0;border-radius:8px;
      box-shadow:0 8px 32px rgba(30, 64, 175, 0.15);
      opacity:0;visibility:hidden;transform:translateY(-10px);
      transition:all 0.2s ease;z-index:1000;
      margin-top:2px;min-width:120px;
    }
    .lang-menu.show{opacity:1;visibility:visible;transform:translateY(0)}
    .lang-option{
      display:flex;align-items:center;gap:6px;
      padding:8px 10px;cursor:pointer;transition:var(--transition);
      border:none;background:none;width:100%;text-align:left;
      font-size:12px;color:var(--ink-light);
    }
    .lang-option:hover{background:linear-gradient(135deg, #f1f5f9, #e2e8f0)}
    .lang-option:focus{outline:none;background:linear-gradient(135deg, var(--brand), var(--brand-light));color:#fff}
    .lang-option.active{background:linear-gradient(135deg, #eff6ff, #dbeafe);color:var(--brand);font-weight:600}
    .lang-option:first-child{border-radius:7px 7px 0 0}
    .lang-option:last-child{border-radius:0 0 7px 7px}
    .lang-option:only-child{border-radius:7px}
    .lang-check{width:14px;height:14px;display:flex;align-items:center;justify-content:center;font-size:10px;color:var(--brand)}

    /* ===== Page Header ===== */
    .page-header{
      position:relative;min-height:60vh;display:flex;align-items:center;justify-content:center;
      background:linear-gradient(135deg, #dbeafe 0%, #f0f9ff 50%, #fef3c7 100%);
      overflow:hidden;
    }
    .page-header::before{
      content:"";position:absolute;inset:0;
      background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="20" cy="20" r="1" fill="%23ffffff" opacity="0.1"/><circle cx="80" cy="40" r="0.5" fill="%23ffffff" opacity="0.1"/><circle cx="40" cy="80" r="1.5" fill="%23ffffff" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
    }
    .page-header-content{
      position:relative;z-index:2;text-align:center;max-width:800px;padding:0 20px;
    }
    .page-title{
      font-size:48px;font-weight:800;margin:0 0 16px;
      background:linear-gradient(135deg, var(--brand-ink), var(--brand));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
    }
    .page-subtitle{color:var(--ink-light);font-size:18px;line-height:1.6;margin:0}

    /* ===== Contact Form ===== */
    .contact-form-section{
      padding:80px 0;
      background:linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #f8fafc 100%);
    }
    .form-container{
      max-width:900px;margin:0 auto;
      background:linear-gradient(135deg, #ffffff, #f8fafc);
      border-radius:20px;box-shadow:var(--shadow-hover);padding:48px;
      border:1px solid rgba(226, 232, 240, 0.8);position:relative;overflow:hidden;
    }
    .form-container::before{
      content:"";position:absolute;top:0;left:0;right:0;height:5px;
      background:linear-gradient(90deg, var(--brand), var(--accent), var(--gold));
      opacity:0.8;
    }
    .form-header{
      text-align:center;margin-bottom:40px;
    }
    .form-title{
      font-size:28px;font-weight:700;margin:0 0 16px;
      color:var(--brand-ink);
    }
    .form-desc{
      color:var(--ink-light);font-size:16px;line-height:1.6;margin:0;
    }
    .contact-form{
      display:grid;gap:24px;
    }
    .form-group{
      display:flex;flex-direction:column;gap:8px;
    }
    .form-row{
      display:grid;grid-template-columns:1fr 1fr;gap:24px;
    }
    .form-label{
      font-weight:600;color:var(--brand-ink);font-size:14px;
      display:flex;align-items:center;gap:4px;
    }
    .required{
      color:var(--error);font-size:12px;
    }
    .form-input, .form-select, .form-textarea{
      padding:16px;border:1px solid #e2e8f0;border-radius:8px;
      background:linear-gradient(135deg, #ffffff, #f8fafc);
      transition:var(--transition);font-size:14px;font-family:inherit;
    }
    .form-input:focus, .form-select:focus, .form-textarea:focus{
      outline:none;border-color:var(--brand);
      box-shadow:0 0 0 3px rgba(30, 64, 175, 0.1);
      background:#ffffff;
    }
    .form-textarea{
      resize:vertical;min-height:120px;
    }
    .form-submit{
      background:linear-gradient(135deg, var(--brand), var(--brand-light));
      color:#fff;border:none;padding:16px 32px;border-radius:12px;
      font-weight:600;font-size:16px;cursor:pointer;
      transition:var(--transition);position:relative;overflow:hidden;
    }
    .form-submit::before{
      content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;
      background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent);
      transition:left 0.5s ease;
    }
    .form-submit:hover::before{left:100%}
    .form-submit:hover{
      background:linear-gradient(135deg, #1e3a8a, var(--brand));
      transform:translateY(-2px);box-shadow:0 8px 32px rgba(30, 64, 175, 0.4);
    }
    .form-submit:disabled{
      opacity:0.6;cursor:not-allowed;transform:none;
    }

    /* ===== Success/Error States ===== */
    .form-success{
      background:linear-gradient(135deg, #f0fdf4, #dcfce7);
      border:1px solid rgba(34, 197, 94, 0.3);
      border-radius:8px;padding:16px;margin-bottom:24px;
      color:var(--success);text-align:center;font-weight:600;
    }
    .form-error{
      background:linear-gradient(135deg, #fef2f2, #fee2e2);
      border:1px solid rgba(239, 68, 68, 0.3);
      border-radius:8px;padding:16px;margin-bottom:24px;
      color:var(--error);text-align:center;font-weight:600;
    }
    .field-error{
      color:var(--error);font-size:12px;margin-top:4px;
    }

    /* ===== Footer ===== */
    footer{padding:32px 0;color:var(--muted-light);font-size:13px;text-align:center;border-top:1px solid #e2e8f0;background:linear-gradient(135deg, #0f172a, #1e293b);color:#94a3b8}

    /* ===== Responsive ===== */
    @media (max-width: 1024px){
      .form-row{grid-template-columns:1fr}
    }
    @media (max-width: 640px){
      .page-title{font-size:36px}
      .form-container{padding:32px}
      .lang-current{min-width:70px;padding:4px 8px;font-size:11px;min-height:32px}
      .lang-text{font-size:11px}
      .lang-icon{font-size:12px}
      .lang-arrow{font-size:7px}
      .site-header .row{padding:10px 0}
      .brand .name{font-size:14px}
      .brand img{height:36px}
      .lang-menu{min-width:100px}
      .lang-option{padding:6px 8px;font-size:11px}
    }

    /* ===== Animations ===== */
    .fade-up{opacity:0;transform:translateY(20px);animation:fadeUp .8s ease forwards}
    @keyframes fadeUp{to{opacity:1;transform:none}}
    
    .fade-in{opacity:0;animation:fadeIn 0.8s ease forwards}
    @keyframes fadeIn{to{opacity:1}}

    /* ===== Accessibility ===== */
    @media (prefers-reduced-motion: reduce){
      *{animation-duration:0.01ms !important;animation-iteration-count:1 !important;transition-duration:0.01ms !important}
      html{scroll-behavior:auto}
    }

    /* ===== Focus styles ===== */
    *:focus{outline:2px solid var(--brand);outline-offset:2px}

    /* ===== Helper Text ===== */
    .helper-text{
      font-size:12px;color:var(--muted);margin-top:4px;line-height:1.4;
    }

    /* ===== Section Divider ===== */
    .section-divider{
      height:2px;background:linear-gradient(90deg, transparent, var(--brand-light), transparent);
      margin:32px 0;opacity:0.3;
    }

    /* ===== Custom Checkbox ===== */
    .checkbox-grid{
      display:grid;grid-template-columns:repeat(auto-fill, minmax(200px, 1fr));gap:16px;
      margin-top:12px;
    }
    .checkbox-item{
      display:flex;align-items:center;gap:10px;cursor:pointer;
      padding:12px 16px;border-radius:8px;
      background:linear-gradient(135deg, #f8fafc, #f1f5f9);
      border:1px solid #e2e8f0;transition:var(--transition);
    }
    .checkbox-item:hover{
      background:linear-gradient(135deg, #f1f5f9, #e2e8f0);
      border-color:var(--brand-light);
    }
    .checkbox-item input[type="checkbox"]{
      width:20px;height:20px;cursor:pointer;
      accent-color:var(--brand);
    }
    .checkbox-item label{
      cursor:pointer;font-size:14px;color:var(--ink);margin:0;
      user-select:none;
    }
    .checkbox-item input[type="checkbox"]:checked + label{
      font-weight:600;color:var(--brand);
    }

    /* ===== Train Line Selection ===== */
    .train-select-container{
      display:grid;grid-template-columns:1fr 1fr;gap:16px;
    }
    .station-select{
      display:none;
    }
    .station-select.show{
      display:block;
    }
    .other-input-container{
      display:none;
    }
    .other-input-container.show{
      display:block;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="site-header">
    <div class="container row">
      <a href="#" class="brand">
        <img src="logo.png" alt="Smart Eyes" onerror="this.style.display='none'" />
        <div class="name">SMART EYES</div>
      </a>
      
      <div class="nav-container">
        <!-- Language Dropdown -->
        <div class="lang-dropdown" id="langDropdown">
          <button class="lang-current" id="langCurrent" aria-haspopup="true" aria-expanded="false">
            <span class="lang-icon">ğŸŒ</span>
            <span class="lang-text">æ—¥æœ¬èª</span>
            <span class="lang-arrow">â–¼</span>
          </button>
          <div class="lang-menu" id="langMenu" role="menu">
            <!-- Language options will be dynamically generated by JS -->
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Page Header -->
  <section class="page-header">
    <div class="page-header-content fade-in">
      <h1 class="page-title" data-i18n="rental.pageTitle">è³ƒè²¸ç‰©ä»¶ãŠå•ã„åˆã‚ã›</h1>
      <p class="page-subtitle" data-i18n="rental.pageSubtitle">ã”å¸Œæœ›ã®æ¡ä»¶ã‚’ãŠèã‹ã›ãã ã•ã„</p>
    </div>
  </section>

  <!-- Rental Form -->
  <section class="contact-form-section">
    <div class="container">
      <div class="form-container fade-up">
        <div class="form-header">
          <h2 class="form-title" data-i18n="rental.formTitle">è³ƒè²¸ç‰©ä»¶ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ </h2>
          <p class="form-desc" data-i18n="rental.formDescription">
            ä¸‹è¨˜ãƒ•ã‚©ãƒ¼ãƒ ã«ã”å…¥åŠ›ã„ãŸã ãã€é€ä¿¡ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
            2å–¶æ¥­æ—¥ä»¥å†…ã«ã”è¿”ä¿¡ã„ãŸã—ã¾ã™ã€‚
          </p>
        </div>
        
        <div id="formMessage"></div>
        
        <form class="contact-form" id="rentalForm">
          <!-- åŸºæœ¬æƒ…å ± -->
          <div class="form-group">
            <label class="form-label" for="fullName">
              <span data-i18n="rental.formFullName">ãŠåå‰</span>
              <span class="required">*</span>
            </label>
            <input type="text" id="fullName" name="fullName" class="form-input" required>
            <div class="field-error" id="fullNameError"></div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="email">
                <span data-i18n="rental.formEmail">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</span>
                <span class="required">*</span>
              </label>
              <input type="email" id="email" name="email" class="form-input" required>
              <div class="field-error" id="emailError"></div>
            </div>
            <div class="form-group">
              <label class="form-label" for="phone">
                <span data-i18n="rental.formPhone">é›»è©±ç•ªå·</span>
                <span class="required">*</span>
              </label>
              <input type="tel" id="phone" name="phone" class="form-input" required>
              <div class="field-error" id="phoneError"></div>
            </div>
          </div>

          <div class="section-divider"></div>

          <!-- è³ƒè²¸ç‰©ä»¶ã®å¸Œæœ›æ¡ä»¶ -->
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="propertyType">
                <span data-i18n="rental.formPropertyType">ç‰©ä»¶ã‚¿ã‚¤ãƒ—</span>
                <span class="required">*</span>
              </label>
              <select id="propertyType" name="propertyType" class="form-select" required>
                <option value="" data-i18n="rental.formPropertyTypeSelect">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="apartment" data-i18n="rental.formPropertyTypeApartment">ãƒãƒ³ã‚·ãƒ§ãƒ³ãƒ»ã‚¢ãƒ‘ãƒ¼ãƒˆ</option>
                <option value="house" data-i18n="rental.formPropertyTypeHouse">ä¸€æˆ¸å»ºã¦</option>
                <option value="office" data-i18n="rental.formPropertyTypeOffice">ã‚ªãƒ•ã‚£ã‚¹ãƒ»äº‹å‹™æ‰€</option>
                <option value="store" data-i18n="rental.formPropertyTypeStore">åº—èˆ—</option>
                <option value="other" data-i18n="rental.formPropertyTypeOther">ãã®ä»–</option>
              </select>
              <div class="field-error" id="propertyTypeError"></div>
            </div>
            <div class="form-group">
              <label class="form-label" for="budget">
                <span data-i18n="rental.formBudget">ã”äºˆç®—ï¼ˆæœˆé¡ï¼‰</span>
                <span class="required">*</span>
              </label>
              <select id="budget" name="budget" class="form-select" required>
                <option value="" data-i18n="rental.formBudgetSelect">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="~50000" data-i18n="rental.formBudget50">5ä¸‡å††ä»¥ä¸‹</option>
                <option value="50000-100000" data-i18n="rental.formBudget50to100">5ä¸‡å††ã€œ10ä¸‡å††</option>
                <option value="100000-150000" data-i18n="rental.formBudget100to150">10ä¸‡å††ã€œ15ä¸‡å††</option>
                <option value="150000-200000" data-i18n="rental.formBudget150to200">15ä¸‡å††ã€œ20ä¸‡å††</option>
                <option value="200000-300000" data-i18n="rental.formBudget200to300">20ä¸‡å††ã€œ30ä¸‡å††</option>
                <option value="300000+" data-i18n="rental.formBudget300">30ä¸‡å††ä»¥ä¸Š</option>
              </select>
              <div class="field-error" id="budgetError"></div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="area">
                <span data-i18n="rental.formArea">å¸Œæœ›ã‚¨ãƒªã‚¢</span>
                <span class="required">*</span>
              </label>
              <select id="area" name="area" class="form-select" required>
                <option value="" data-i18n="rental.formAreaSelect">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="shinjuku" data-i18n="rental.formAreaShinjuku">æ–°å®¿åŒº</option>
                <option value="shibuya" data-i18n="rental.formAreaShibuya">æ¸‹è°·åŒº</option>
                <option value="minato" data-i18n="rental.formAreaMinato">æ¸¯åŒº</option>
                <option value="chiyoda" data-i18n="rental.formAreaChiyoda">åƒä»£ç”°åŒº</option>
                <option value="chuo" data-i18n="rental.formAreaChuo">ä¸­å¤®åŒº</option>
                <option value="meguro" data-i18n="rental.formAreaMeguro">ç›®é»’åŒº</option>
                <option value="setagaya" data-i18n="rental.formAreaSetagaya">ä¸–ç”°è°·åŒº</option>
                <option value="other-tokyo" data-i18n="rental.formAreaOtherTokyo">ãã®ä»–æ±äº¬23åŒº</option>
                <option value="other" data-i18n="rental.formAreaOther">ãã®ä»–</option>
              </select>
              <div class="field-error" id="areaError"></div>
            </div>
            <div class="form-group">
              <label class="form-label" for="rooms">
                <span data-i18n="rental.formRooms">é–“å–ã‚Š</span>
                <span class="required">*</span>
              </label>
              <select id="rooms" name="rooms" class="form-select" required>
                <option value="" data-i18n="rental.formRoomsSelect">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="1R" data-i18n="rental.formRooms1R">ãƒ¯ãƒ³ãƒ«ãƒ¼ãƒ </option>
                <option value="1K" data-i18n="rental.formRooms1K">1K</option>
                <option value="1DK" data-i18n="rental.formRooms1DK">1DK</option>
                <option value="1LDK" data-i18n="rental.formRooms1LDK">1LDK</option>
                <option value="2K" data-i18n="rental.formRooms2K">2K</option>
                <option value="2DK" data-i18n="rental.formRooms2DK">2DK</option>
                <option value="2LDK" data-i18n="rental.formRooms2LDK">2LDK</option>
                <option value="3LDK+" data-i18n="rental.formRooms3LDK">3LDKä»¥ä¸Š</option>
                <option value="flexible" data-i18n="rental.formRoomsFlexible">ç›¸è«‡å¯</option>
              </select>
              <div class="field-error" id="roomsError"></div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="moveInDate">
                <span data-i18n="rental.formMoveInDate">å…¥å±…å¸Œæœ›æ™‚æœŸ</span>
                <span class="required">*</span>
              </label>
              <select id="moveInDate" name="moveInDate" class="form-select" required>
                <option value="" data-i18n="rental.formMoveInDateSelect">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="immediate" data-i18n="rental.formMoveInImmediate">ã™ã</option>
                <option value="1month" data-i18n="rental.formMoveIn1Month">1ãƒ¶æœˆä»¥å†…</option>
                <option value="2months" data-i18n="rental.formMoveIn2Months">2ãƒ¶æœˆä»¥å†…</option>
                <option value="3months" data-i18n="rental.formMoveIn3Months">3ãƒ¶æœˆä»¥å†…</option>
                <option value="flexible" data-i18n="rental.formMoveInFlexible">ç›¸è«‡å¯</option>
              </select>
              <div class="field-error" id="moveInDateError"></div>
            </div>
            <div class="form-group">
              <label class="form-label" for="language">
                <span data-i18n="rental.formLanguage">ã”å¸Œæœ›ã®å¯¾å¿œè¨€èª</span>
              </label>
              <select id="language" name="language" class="form-select">
                <option value="ja" data-i18n="rental.formLanguageJa">æ—¥æœ¬èª</option>
                <option value="zh" data-i18n="rental.formLanguageZh">ä¸­å›½èªï¼ˆç°¡ä½“å­—ï¼‰</option>
                <option value="zh-Hant" data-i18n="rental.formLanguageZhHant">ä¸­å›½èªï¼ˆç¹ä½“å­—ï¼‰</option>
                <option value="en" data-i18n="rental.formLanguageEn">è‹±èª</option>
                <option value="ko" data-i18n="rental.formLanguageKo">éŸ“å›½èª</option>
                <option value="vi" data-i18n="rental.formLanguageVi">ãƒ™ãƒˆãƒŠãƒ èª</option>
                <option value="ne" data-i18n="rental.formLanguageNe">ãƒãƒ‘ãƒ¼ãƒ«èª</option>
              </select>
            </div>
          </div>

          <div class="section-divider"></div>

          <!-- é›»è»Šç·šè·¯ãƒ»é§… -->
          <div class="form-group">
            <label class="form-label">
              <span data-i18n="rental.formTrainLine">æœ€å¯„ã‚Šé§…ï¼ˆé›»è»Šç·šè·¯ï¼‰</span>
            </label>
            <div class="train-select-container">
              <div class="form-group" style="margin:0">
                <select id="trainLine" name="trainLine" class="form-select">
                  <option value="" data-i18n="rental.formTrainLineSelect">é¸æŠã—ã¦ãã ã•ã„</option>
                  <option value="yamanote" data-i18n="rental.formTrainLineYamanote">JRå±±æ‰‹ç·š</option>
                  <option value="chuo" data-i18n="rental.formTrainLineChuo">JRä¸­å¤®ç·š</option>
                  <option value="sobu" data-i18n="rental.formTrainLineSobu">JRç·æ­¦ç·š</option>
                  <option value="keio" data-i18n="rental.formTrainLineKeio">äº¬ç‹ç·š</option>
                  <option value="odakyu" data-i18n="rental.formTrainLineOdakyu">å°ç”°æ€¥ç·š</option>
                  <option value="tokyu" data-i18n="rental.formTrainLineTokyu">æ±æ€¥æ±æ¨ªç·š</option>
                  <option value="seibu" data-i18n="rental.formTrainLineSeibu">è¥¿æ­¦æ–°å®¿ç·š</option>
                  <option value="marunouchi" data-i18n="rental.formTrainLineMarunouchi">ä¸¸ãƒå†…ç·š</option>
                  <option value="tozai" data-i18n="rental.formTrainLineTozai">æ±è¥¿ç·š</option>
                  <option value="ginza" data-i18n="rental.formTrainLineGinza">éŠ€åº§ç·š</option>
                  <option value="fukutoshin" data-i18n="rental.formTrainLineFukutoshin">å‰¯éƒ½å¿ƒç·š</option>
                  <option value="other" data-i18n="rental.formTrainLineOther">ãã®ä»–</option>
                </select>
              </div>
              <div class="form-group station-select" id="stationSelectContainer" style="margin:0">
                <select id="station" name="station" class="form-select">
                  <option value="" data-i18n="rental.formStationSelect">ã¾ãšç·šè·¯ã‚’é¸æŠ</option>
                </select>
              </div>
            </div>
            <div class="other-input-container" id="otherTrainContainer">
              <input type="text" id="otherTrain" name="otherTrain" class="form-input" 
                     placeholder="ãã®ä»–ã®ç·šè·¯ãƒ»é§…ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
                     data-i18n="rental.formOtherTrainPlaceholder">
            </div>
            <div class="helper-text" data-i18n="rental.formTrainHelper">
              ã”å¸Œæœ›ã®æœ€å¯„ã‚Šé§…ãŒã‚ã‚‹å ´åˆã¯ç·šè·¯ã¨é§…ã‚’é¸æŠã—ã¦ãã ã•ã„
            </div>
          </div>

          <div class="section-divider"></div>

          <!-- ç‰©ä»¶æ¡ä»¶ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ -->
          <div class="form-group">
            <label class="form-label">
              <span data-i18n="rental.formConditions">ç‰©ä»¶ã®æ¡ä»¶</span>
            </label>
            <div class="checkbox-grid">
              <div class="checkbox-item">
                <input type="checkbox" id="bathToiletSeparate" name="bathToiletSeparate" value="yes">
                <label for="bathToiletSeparate" data-i18n="rental.conditionBathToilet">ãƒã‚¹ãƒ»ãƒˆã‚¤ãƒ¬åˆ¥</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="parking" name="parking" value="yes">
                <label for="parking" data-i18n="rental.conditionParking">é§è»Šå ´</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="bikeParking" name="bikeParking" value="yes">
                <label for="bikeParking" data-i18n="rental.conditionBikeParking">é§è¼ªå ´</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="southFacing" name="southFacing" value="yes">
                <label for="southFacing" data-i18n="rental.conditionSouthFacing">å—å‘ã</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="autoLock" name="autoLock" value="yes">
                <label for="autoLock" data-i18n="rental.conditionAutoLock">ã‚ªãƒ¼ãƒˆãƒ­ãƒƒã‚¯</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="secondFloor" name="secondFloor" value="yes">
                <label for="secondFloor" data-i18n="rental.conditionSecondFloor">2éšä»¥ä¸Š</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="petFriendly" name="petFriendly" value="yes">
                <label for="petFriendly" data-i18n="rental.conditionPetFriendly">ãƒšãƒƒãƒˆå¯</label>
              </div>
            </div>
            <div class="helper-text" data-i18n="rental.formConditionsHelper">
              ã”å¸Œæœ›ã®æ¡ä»¶ãŒã‚ã‚Œã°é¸æŠã—ã¦ãã ã•ã„ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰
            </div>
          </div>

          <div class="section-divider"></div>

          <!-- ãã®ä»–ã®è¦æœ› -->
          <div class="form-group">
            <label class="form-label" for="requirements">
              <span data-i18n="rental.formRequirements">ãã®ä»–ã”è¦æœ›ãƒ»æ¡ä»¶</span>
            </label>
            <textarea id="requirements" name="requirements" class="form-textarea" 
                      data-i18n="rental.formRequirementsPlaceholder" 
                      placeholder="ãƒšãƒƒãƒˆå¯ã€æ¥½å™¨å¯ã€é§è»Šå ´å¿…é ˆãªã©ã€ã”å¸Œæœ›ã®æ¡ä»¶ã‚’ã”è¨˜å…¥ãã ã•ã„"></textarea>
            <div class="helper-text" data-i18n="rental.formRequirementsHelper">
              ä¾‹ï¼šãƒšãƒƒãƒˆå¯ã€æ¥½å™¨å¯ã€ãƒã‚¹ãƒ»ãƒˆã‚¤ãƒ¬åˆ¥ã€é§è»Šå ´å¿…é ˆã€ã‚ªãƒ¼ãƒˆãƒ­ãƒƒã‚¯ã€2éšä»¥ä¸Šãªã©
            </div>
          </div>
          
          <button type="submit" class="form-submit" id="submitButton">
            <span data-i18n="rental.formSubmit">é€ä¿¡ã™ã‚‹</span>
          </button>
        </form>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <p data-i18n="footer.copyright">&copy; 2024 æ ªå¼ä¼šç¤¾ã‚¹ãƒãƒ¼ãƒˆã‚¢ã‚¤ã‚º All Rights Reserved.</p>
    </div>
  </footer>

  <script>
    // ===== Train Line & Station Data =====
    const TRAIN_STATIONS = {
      yamanote: ['æ±äº¬', 'æœ‰æ¥½ç”º', 'æ–°æ©‹', 'æµœæ¾ç”º', 'ç”°ç”º', 'å“å·', 'å¤§å´', 'äº”åç”°', 'ç›®é»’', 'æµæ¯”å¯¿', 'æ¸‹è°·', 'åŸå®¿', 'ä»£ã€…æœ¨', 'æ–°å®¿', 'æ–°å¤§ä¹…ä¿', 'é«˜ç”°é¦¬å ´', 'ç›®ç™½', 'æ± è¢‹', 'å¤§å¡š', 'å·£é´¨', 'é§’è¾¼', 'ç”°ç«¯', 'è¥¿æ—¥æš®é‡Œ', 'æ—¥æš®é‡Œ', 'é¶¯è°·', 'ä¸Šé‡', 'å¾¡å¾’ç”º', 'ç§‹è‘‰åŸ', 'ç¥ç”°'],
      chuo: ['æ±äº¬', 'ç¥ç”°', 'å¾¡èŒ¶ãƒæ°´', 'æ°´é“æ©‹', 'é£¯ç”°æ©‹', 'å¸‚ãƒ¶è°·', 'å››ãƒ„è°·', 'ä¿¡æ¿ƒç”º', 'åƒé§„ã‚±è°·', 'ä»£ã€…æœ¨', 'æ–°å®¿', 'å¤§ä¹…ä¿', 'æ±ä¸­é‡', 'ä¸­é‡', 'é«˜å††å¯º', 'é˜¿ä½ã‚±è°·', 'è»çªª', 'è¥¿è»çªª', 'å‰ç¥¥å¯º', 'ä¸‰é·¹', 'æ­¦è”µå¢ƒ', 'æ±å°é‡‘äº•', 'æ­¦è”µå°é‡‘äº•', 'å›½åˆ†å¯º', 'è¥¿å›½åˆ†å¯º', 'å›½ç«‹', 'ç«‹å·'],
      sobu: ['åƒè‘‰', 'è¥¿åƒè‘‰', 'ç¨²æ¯›', 'æ–°æ¤œè¦‹å·', 'å¹•å¼µ', 'å¹•å¼µæœ¬éƒ·', 'æ´¥ç”°æ²¼', 'æ±èˆ¹æ©‹', 'èˆ¹æ©‹', 'è¥¿èˆ¹æ©‹', 'ä¸‹ç·ä¸­å±±', 'æœ¬å…«å¹¡', 'å¸‚å·', 'å°å²©', 'æ–°å°å²©', 'å¹³äº•', 'äº€æˆ¸', 'éŒ¦ç³¸ç”º', 'ä¸¡å›½', 'æµ…è‰æ©‹', 'ç§‹è‘‰åŸ', 'å¾¡èŒ¶ãƒæ°´', 'æ°´é“æ©‹', 'é£¯ç”°æ©‹', 'å¸‚ãƒ¶è°·', 'å››ãƒ„è°·', 'ä¿¡æ¿ƒç”º', 'åƒé§„ã‚±è°·', 'ä»£ã€…æœ¨', 'æ–°å®¿'],
      keio: ['æ–°å®¿', 'åˆå°', 'å¹¡ãƒ¶è°·', 'ç¬¹å¡š', 'ä»£ç”°æ©‹', 'æ˜å¤§å‰', 'ä¸‹é«˜äº•æˆ¸', 'æ¡œä¸Šæ°´', 'ä¸ŠåŒ—æ²¢', 'å…«å¹¡å±±', 'èŠ¦èŠ±å…¬åœ’', 'åƒæ­³çƒå±±', 'ä»™å·', 'ã¤ã¤ã˜ãƒ¶ä¸˜', 'æŸ´å´', 'å›½é ˜', 'å¸ƒç”°', 'èª¿å¸ƒ', 'è¥¿èª¿å¸ƒ', 'é£›ç”°çµ¦', 'æ­¦è”µé‡å°', 'å¤šç£¨éœŠåœ’', 'æ±åºœä¸­', 'åºœä¸­', 'åˆ†å€æ²³åŸ', 'ä¸­æ²³åŸ', 'è–è¹Ÿæ¡œãƒ¶ä¸˜', 'ç™¾è‰åœ’', 'é«˜å¹¡ä¸å‹•'],
      odakyu: ['æ–°å®¿', 'å—æ–°å®¿', 'å‚å®®æ©‹', 'ä»£ã€…æœ¨å…«å¹¡', 'ä»£ã€…æœ¨ä¸ŠåŸ', 'æ±åŒ—æ²¢', 'ä¸‹åŒ—æ²¢', 'ä¸–ç”°è°·ä»£ç”°', 'æ¢…ãƒ¶ä¸˜', 'è±ªå¾³å¯º', 'çµŒå ‚', 'åƒæ­³èˆ¹æ©‹', 'ç¥–å¸«ãƒ¶è°·å¤§è”µ', 'æˆåŸå­¦åœ’å‰', 'å–œå¤šè¦‹', 'ç‹›æ±Ÿ', 'å’Œæ³‰å¤šæ‘©å·', 'ç™»æˆ¸', 'å‘ãƒ¶ä¸˜éŠåœ’', 'ç”Ÿç”°', 'èª­å£²ãƒ©ãƒ³ãƒ‰å‰', 'ç™¾åˆãƒ¶ä¸˜', 'æ–°ç™¾åˆãƒ¶ä¸˜', 'æŸ¿ç”Ÿ', 'é¶´å·', 'ç‰å·å­¦åœ’å‰', 'ç”ºç”°'],
      tokyu: ['æ¸‹è°·', 'ä»£å®˜å±±', 'ä¸­ç›®é»’', 'ç¥å¤©å¯º', 'å­¦èŠ¸å¤§å­¦', 'éƒ½ç«‹å¤§å­¦', 'è‡ªç”±ãŒä¸˜', 'ç”°åœ’èª¿å¸ƒ', 'å¤šæ‘©å·', 'æ–°ä¸¸å­', 'æ­¦è”µå°æ‰', 'å…ƒä½å‰', 'æ—¥å‰', 'ç¶±å³¶', 'å¤§å€‰å±±', 'èŠå', 'å¦™è“®å¯º', 'ç™½æ¥½', 'æ±ç™½æ¥½', 'åç”º', 'æ¨ªæµœ'],
      seibu: ['è¥¿æ­¦æ–°å®¿', 'é«˜ç”°é¦¬å ´', 'ä¸‹è½åˆ', 'ä¸­äº•', 'æ–°äº•è–¬å¸«å‰', 'æ²¼è¢‹', 'é‡æ–¹', 'éƒ½ç«‹å®¶æ”¿', 'é·ºãƒå®®', 'ä¸‹äº•è‰', 'äº•è»', 'ä¸Šäº•è‰', 'ä¸ŠçŸ³ç¥äº•', 'æ­¦è”µé–¢', 'æ±ä¼è¦‹', 'è¥¿æ­¦æŸ³æ²¢', 'ç”°ç„¡', 'èŠ±å°é‡‘äº•', 'å°å¹³', 'ä¹…ç±³å·', 'æ±æ‘å±±'],
      marunouchi: ['æ± è¢‹', 'æ–°å¤§å¡š', 'èŒ—è·è°·', 'å¾Œæ¥½åœ’', 'æœ¬éƒ·ä¸‰ä¸ç›®', 'å¾¡èŒ¶ãƒæ°´', 'æ·¡è·¯ç”º', 'å¤§æ‰‹ç”º', 'æ±äº¬', 'éŠ€åº§', 'éœã‚±é–¢', 'å›½ä¼šè­°äº‹å ‚å‰', 'èµ¤å‚è¦‹é™„', 'å››ãƒ„è°·', 'å››è°·ä¸‰ä¸ç›®', 'æ–°å®¿å¾¡è‹‘å‰', 'æ–°å®¿ä¸‰ä¸ç›®', 'æ–°å®¿', 'è¥¿æ–°å®¿', 'ä¸­é‡å‚ä¸Š', 'æ–°ä¸­é‡', 'æ±é«˜å††å¯º', 'æ–°é«˜å††å¯º', 'å—é˜¿ä½ã‚±è°·', 'è»çªª'],
      tozai: ['ä¸­é‡', 'è½åˆ', 'é«˜ç”°é¦¬å ´', 'æ—©ç¨²ç”°', 'ç¥æ¥½å‚', 'é£¯ç”°æ©‹', 'ä¹æ®µä¸‹', 'ç«¹æ©‹', 'å¤§æ‰‹ç”º', 'æ—¥æœ¬æ©‹', 'èŒ…å ´ç”º', 'é–€å‰ä»²ç”º', 'æœ¨å ´', 'æ±é™½ç”º', 'å—ç ‚ç”º', 'è¥¿è‘›è¥¿', 'è‘›è¥¿', 'æµ¦å®‰', 'å—è¡Œå¾³', 'è¡Œå¾³', 'å¦™å…¸', 'åŸæœ¨ä¸­å±±', 'è¥¿èˆ¹æ©‹'],
      ginza: ['æ¸‹è°·', 'è¡¨å‚é“', 'å¤–è‹‘å‰', 'é’å±±ä¸€ä¸ç›®', 'èµ¤å‚è¦‹é™„', 'æºœæ± å±±ç‹', 'è™ãƒé–€', 'æ–°æ©‹', 'éŠ€åº§', 'äº¬æ©‹', 'æ—¥æœ¬æ©‹', 'ä¸‰è¶Šå‰', 'ç¥ç”°', 'æœ«åºƒç”º', 'ä¸Šé‡åºƒå°è·¯', 'ä¸Šé‡', 'ç¨²è·ç”º', 'ç”°åŸç”º', 'æµ…è‰'],
      fukutoshin: ['å’Œå…‰å¸‚', 'åœ°ä¸‹é‰„æˆå¢—', 'åœ°ä¸‹é‰„èµ¤å¡š', 'å¹³å’Œå°', 'æ°·å·å°', 'å°ç«¹å‘åŸ', 'åƒå·', 'è¦ç”º', 'æ± è¢‹', 'é›‘å¸ãŒè°·', 'è¥¿æ—©ç¨²ç”°', 'æ±æ–°å®¿', 'æ–°å®¿ä¸‰ä¸ç›®', 'åŒ—å‚é“', 'æ˜æ²»ç¥å®®å‰', 'æ¸‹è°·', 'æ–°å®¿'],
    };

    // ===== Rental Form Manager =====
    class RentalFormManager {
      constructor() {
        this.form = document.getElementById('rentalForm');
        this.submitButton = document.getElementById('submitButton');
        this.messageContainer = document.getElementById('formMessage');
        this.trainLineSelect = document.getElementById('trainLine');
        this.stationSelect = document.getElementById('station');
        this.stationContainer = document.getElementById('stationSelectContainer');
        this.otherTrainContainer = document.getElementById('otherTrainContainer');
        this.otherTrainInput = document.getElementById('otherTrain');
        this.init();
      }

      init() {
        this.form.addEventListener('submit', (e) => this.handleSubmit(e));
        this.trainLineSelect.addEventListener('change', (e) => this.handleTrainLineChange(e));
      }

      handleTrainLineChange(e) {
        const selectedLine = e.target.value;
        
        if (selectedLine === 'other') {
          // Show other input, hide station select
          this.stationContainer.classList.remove('show');
          this.otherTrainContainer.classList.add('show');
          this.otherTrainInput.required = false;
        } else if (selectedLine && TRAIN_STATIONS[selectedLine]) {
          // Show station select with options
          this.stationContainer.classList.add('show');
          this.otherTrainContainer.classList.remove('show');
          this.populateStations(selectedLine);
        } else {
          // Hide both
          this.stationContainer.classList.remove('show');
          this.otherTrainContainer.classList.remove('show');
        }
      }

      populateStations(line) {
        const stations = TRAIN_STATIONS[line];
        this.stationSelect.innerHTML = '<option value="">é§…ã‚’é¸æŠã—ã¦ãã ã•ã„</option>';
        
        stations.forEach(station => {
          const option = document.createElement('option');
          option.value = station;
          option.textContent = station;
          this.stationSelect.appendChild(option);
        });
      }

      async handleSubmit(e) {
        e.preventDefault();
        
        if (!this.validateForm()) {
          return;
        }

        this.submitButton.disabled = true;
        const originalText = this.submitButton.querySelector('span').textContent;
        this.submitButton.querySelector('span').textContent = this.getTranslation('rental.formSubmitting', 'é€ä¿¡ä¸­...');

        try {
          await this.submitForm();
          
          this.showMessage(
            this.getTranslation('rental.formSuccessMessage', 'ãŠå•ã„åˆã‚ã›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚2å–¶æ¥­æ—¥ä»¥å†…ã«ã”è¿”ä¿¡ã„ãŸã—ã¾ã™ã€‚'),
            'success'
          );
          
          this.form.reset();
          this.stationContainer.classList.remove('show');
          this.otherTrainContainer.classList.remove('show');
        } catch (error) {
          console.error('Form submission error:', error);
          this.showMessage(
            this.getTranslation('rental.formErrorMessage', 'é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãŠæ‰‹æ•°ã§ã™ãŒã€ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚'),
            'error'
          );
        } finally {
          this.submitButton.disabled = false;
          this.submitButton.querySelector('span').textContent = originalText;
        }
      }

      validateForm() {
        let isValid = true;
        const fields = ['fullName', 'email', 'phone', 'propertyType', 'budget', 'area', 'rooms', 'moveInDate'];
        
        fields.forEach(field => {
          const input = document.getElementById(field);
          const errorDiv = document.getElementById(`${field}Error`);
          
          if (input && input.hasAttribute('required') && !input.value.trim()) {
            if (errorDiv) {
              errorDiv.textContent = this.getTranslation('rental.fieldRequired', 'ã“ã®é …ç›®ã¯å¿…é ˆã§ã™');
            }
            isValid = false;
          } else if (errorDiv) {
            errorDiv.textContent = '';
          }
        });

        // Email validation
        const email = document.getElementById('email');
        const emailError = document.getElementById('emailError');
        if (email && email.value && !this.isValidEmail(email.value)) {
          if (emailError) {
            emailError.textContent = this.getTranslation('rental.invalidEmail', 'æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
          }
          isValid = false;
        }

        return isValid;
      }

      isValidEmail(email) {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
      }

      getCheckedConditions() {
        const conditions = [];
        const checkboxes = [
          { id: 'bathToiletSeparate', label: 'ãƒã‚¹ãƒ»ãƒˆã‚¤ãƒ¬åˆ¥' },
          { id: 'parking', label: 'é§è»Šå ´' },
          { id: 'bikeParking', label: 'é§è¼ªå ´' },
          { id: 'southFacing', label: 'å—å‘ã' },
          { id: 'autoLock', label: 'ã‚ªãƒ¼ãƒˆãƒ­ãƒƒã‚¯' },
          { id: 'secondFloor', label: '2éšä»¥ä¸Š' },
          { id: 'petFriendly', label: 'ãƒšãƒƒãƒˆå¯' }
        ];

        checkboxes.forEach(checkbox => {
          const element = document.getElementById(checkbox.id);
          if (element && element.checked) {
            conditions.push(checkbox.label);
          }
        });

        return conditions;
      }

      getTrainInfo() {
        const trainLine = this.trainLineSelect;
        const station = this.stationSelect;
        const otherTrain = this.otherTrainInput;

        if (trainLine.value === 'other' && otherTrain.value.trim()) {
          return otherTrain.value.trim();
        } else if (trainLine.value && station.value) {
          const lineName = trainLine.options[trainLine.selectedIndex].text;
          return `${lineName} - ${station.value}é§…`;
        } else if (trainLine.value) {
          const lineName = trainLine.options[trainLine.selectedIndex].text;
          return lineName;
        }
        return 'ãªã—';
      }

      async submitForm() {
        const scriptUrl = 'https://script.google.com/macros/s/AKfycbzMWtKd26r5GJrrdYeVWazLOWIdUzpFynCg9VeVDwtxEbEO6z6EcLy7TJjhRAXSpqgtTw/exec';
        
        const propertyType = document.getElementById('propertyType');
        const budget = document.getElementById('budget');
        const area = document.getElementById('area');
        const rooms = document.getElementById('rooms');
        const moveInDate = document.getElementById('moveInDate');
        const requirements = document.getElementById('requirements');

        const conditions = this.getCheckedConditions();
        const trainInfo = this.getTrainInfo();

        const rentalDetails = `
ã€è³ƒè²¸ç‰©ä»¶ãŠå•ã„åˆã‚ã›ã€‘

â–  ç‰©ä»¶ã‚¿ã‚¤ãƒ—: ${propertyType.options[propertyType.selectedIndex].text}
â–  ã”äºˆç®—: ${budget.options[budget.selectedIndex].text}
â–  å¸Œæœ›ã‚¨ãƒªã‚¢: ${area.options[area.selectedIndex].text}
â–  é–“å–ã‚Š: ${rooms.options[rooms.selectedIndex].text}
â–  å…¥å±…å¸Œæœ›æ™‚æœŸ: ${moveInDate.options[moveInDate.selectedIndex].text}
â–  æœ€å¯„ã‚Šé§…: ${trainInfo}

â–  ç‰©ä»¶ã®æ¡ä»¶:
${conditions.length > 0 ? conditions.join('ã€') : 'ãªã—'}

â–  ãã®ä»–ã”è¦æœ›ãƒ»æ¡ä»¶:
${requirements.value || 'ãªã—'}
        `.trim();

        const fullName = document.getElementById('fullName').value;
        const nameParts = fullName.split(/\s+/);
        
        const formData = {
          lastName: nameParts.length > 1 ? nameParts[0] : fullName,
          firstName: nameParts.length > 1 ? nameParts.slice(1).join(' ') : '',
          email: document.getElementById('email').value,
          phone: document.getElementById('phone').value,
          inquiryType: 'rent',
          budget: budget.value,
          language: document.getElementById('language').value,
          message: rentalDetails,
          timestamp: new Date().toISOString(),
          source: 'rental_form'
        };
        
        await fetch(scriptUrl, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(formData)
        });
      }

      showMessage(message, type) {
        this.messageContainer.innerHTML = `
          <div class="form-${type}">
            ${message}
          </div>
        `;
        
        setTimeout(() => {
          this.messageContainer.innerHTML = '';
        }, 5000);

        this.messageContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }

      getTranslation(key, fallback) {
        return fallback;
      }
    }

    // ===== I18n Manager =====
    class I18nManager {
      constructor() {
        this.currentLang = 'ja';
        this.loadedLanguages = {};
        this.languages = {
          ja: 'æ—¥æœ¬èª',
          ko: 'í•œêµ­ì–´',
          zh: 'ç®€ä½“ä¸­æ–‡',
          'zh-Hant': 'ç¹é«”ä¸­æ–‡',
          en: 'English',
          vi: 'Tiáº¿ng Viá»‡t',
          ne: 'à¤¨à¥‡à¤ªà¤¾à¤²à¥€'
        };
        this.fallbackLang = 'ja';
        
        // ç§Ÿè³ƒè¡¨å–®çš„ç¿»è­¯æ•¸æ“šï¼ˆå…§åµŒï¼‰
        this.translations = {
          ja: {
            rental: {
              pageTitle: 'è³ƒè²¸ç‰©ä»¶ãŠå•ã„åˆã‚ã›',
              pageSubtitle: 'ã”å¸Œæœ›ã®æ¡ä»¶ã‚’ãŠèã‹ã›ãã ã•ã„',
              formTitle: 'è³ƒè²¸ç‰©ä»¶ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ ',
              formDescription: 'ä¸‹è¨˜ãƒ•ã‚©ãƒ¼ãƒ ã«ã”å…¥åŠ›ã„ãŸã ãã€é€ä¿¡ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚2å–¶æ¥­æ—¥ä»¥å†…ã«ã”è¿”ä¿¡ã„ãŸã—ã¾ã™ã€‚',
              formFullName: 'ãŠåå‰',
              formEmail: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
              formPhone: 'é›»è©±ç•ªå·',
              formPropertyType: 'ç‰©ä»¶ã‚¿ã‚¤ãƒ—',
              formPropertyTypeSelect: 'é¸æŠã—ã¦ãã ã•ã„',
              formPropertyTypeApartment: 'ãƒãƒ³ã‚·ãƒ§ãƒ³ãƒ»ã‚¢ãƒ‘ãƒ¼ãƒˆ',
              formPropertyTypeHouse: 'ä¸€æˆ¸å»ºã¦',
              formPropertyTypeOffice: 'ã‚ªãƒ•ã‚£ã‚¹ãƒ»äº‹å‹™æ‰€',
              formPropertyTypeStore: 'åº—èˆ—',
              formPropertyTypeOther: 'ãã®ä»–',
              formBudget: 'ã”äºˆç®—ï¼ˆæœˆé¡ï¼‰',
              formBudgetSelect: 'é¸æŠã—ã¦ãã ã•ã„',
              formBudget50: '5ä¸‡å††ä»¥ä¸‹',
              formBudget50to100: '5ä¸‡å††ã€œ10ä¸‡å††',
              formBudget100to150: '10ä¸‡å††ã€œ15ä¸‡å††',
              formBudget150to200: '15ä¸‡å††ã€œ20ä¸‡å††',
              formBudget200to300: '20ä¸‡å††ã€œ30ä¸‡å††',
              formBudget300: '30ä¸‡å††ä»¥ä¸Š',
              formArea: 'å¸Œæœ›ã‚¨ãƒªã‚¢',
              formAreaSelect: 'é¸æŠã—ã¦ãã ã•ã„',
              formAreaShinjuku: 'æ–°å®¿åŒº',
              formAreaShibuya: 'æ¸‹è°·åŒº',
              formAreaMinato: 'æ¸¯åŒº',
              formAreaChiyoda: 'åƒä»£ç”°åŒº',
              formAreaChuo: 'ä¸­å¤®åŒº',
              formAreaMeguro: 'ç›®é»’åŒº',
              formAreaSetagaya: 'ä¸–ç”°è°·åŒº',
              formAreaOtherTokyo: 'ãã®ä»–æ±äº¬23åŒº',
              formAreaOther: 'ãã®ä»–',
              formRooms: 'é–“å–ã‚Š',
              formRoomsSelect: 'é¸æŠã—ã¦ãã ã•ã„',
              formRooms1R: 'ãƒ¯ãƒ³ãƒ«ãƒ¼ãƒ ',
              formRooms1K: '1K',
              formRooms1DK: '1DK',
              formRooms1LDK: '1LDK',
              formRooms2K: '2K',
              formRooms2DK: '2DK',
              formRooms2LDK: '2LDK',
              formRooms3LDK: '3LDKä»¥ä¸Š',
              formRoomsFlexible: 'ç›¸è«‡å¯',
              formMoveInDate: 'å…¥å±…å¸Œæœ›æ™‚æœŸ',
              formMoveInDateSelect: 'é¸æŠã—ã¦ãã ã•ã„',
              formMoveInImmediate: 'ã™ã',
              formMoveIn1Month: '1ãƒ¶æœˆä»¥å†…',
              formMoveIn2Months: '2ãƒ¶æœˆä»¥å†…',
              formMoveIn3Months: '3ãƒ¶æœˆä»¥å†…',
              formMoveInFlexible: 'ç›¸è«‡å¯',
              formLanguage: 'ã”å¸Œæœ›ã®å¯¾å¿œè¨€èª',
              formLanguageJa: 'æ—¥æœ¬èª',
              formLanguageZh: 'ä¸­å›½èªï¼ˆç°¡ä½“å­—ï¼‰',
              formLanguageZhHant: 'ä¸­å›½èªï¼ˆç¹ä½“å­—ï¼‰',
              formLanguageEn: 'è‹±èª',
              formLanguageKo: 'éŸ“å›½èª',
              formLanguageVi: 'ãƒ™ãƒˆãƒŠãƒ èª',
              formLanguageNe: 'ãƒãƒ‘ãƒ¼ãƒ«èª',
              formTrainLine: 'æœ€å¯„ã‚Šé§…ï¼ˆé›»è»Šç·šè·¯ï¼‰',
              formTrainLineSelect: 'é¸æŠã—ã¦ãã ã•ã„',
              formTrainLineYamanote: 'JRå±±æ‰‹ç·š',
              formTrainLineChuo: 'JRä¸­å¤®ç·š',
              formTrainLineSobu: 'JRç·æ­¦ç·š',
              formTrainLineKeio: 'äº¬ç‹ç·š',
              formTrainLineOdakyu: 'å°ç”°æ€¥ç·š',
              formTrainLineTokyu: 'æ±æ€¥æ±æ¨ªç·š',
              formTrainLineSeibu: 'è¥¿æ­¦æ–°å®¿ç·š',
              formTrainLineMarunouchi: 'ä¸¸ãƒå†…ç·š',
              formTrainLineTozai: 'æ±è¥¿ç·š',
              formTrainLineGinza: 'éŠ€åº§ç·š',
              formTrainLineFukutoshin: 'å‰¯éƒ½å¿ƒç·š',
              formTrainLineOther: 'ãã®ä»–',
              formStationSelect: 'ã¾ãšç·šè·¯ã‚’é¸æŠ',
              formOtherTrainPlaceholder: 'ãã®ä»–ã®ç·šè·¯ãƒ»é§…ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
              formTrainHelper: 'ã”å¸Œæœ›ã®æœ€å¯„ã‚Šé§…ãŒã‚ã‚‹å ´åˆã¯ç·šè·¯ã¨é§…ã‚’é¸æŠã—ã¦ãã ã•ã„',
              formConditions: 'ç‰©ä»¶ã®æ¡ä»¶',
              conditionBathToilet: 'ãƒã‚¹ãƒ»ãƒˆã‚¤ãƒ¬åˆ¥',
              conditionParking: 'é§è»Šå ´',
              conditionBikeParking: 'é§è¼ªå ´',
              conditionSouthFacing: 'å—å‘ã',
              conditionAutoLock: 'ã‚ªãƒ¼ãƒˆãƒ­ãƒƒã‚¯',
              conditionSecondFloor: '2éšä»¥ä¸Š',
              conditionPetFriendly: 'ãƒšãƒƒãƒˆå¯',
              formConditionsHelper: 'ã”å¸Œæœ›ã®æ¡ä»¶ãŒã‚ã‚Œã°é¸æŠã—ã¦ãã ã•ã„ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰',
              formRequirements: 'ãã®ä»–ã”è¦æœ›ãƒ»æ¡ä»¶',
              formRequirementsPlaceholder: 'ãã®ä»–ã”å¸Œæœ›ãŒã‚ã‚Œã°ã”è¨˜å…¥ãã ã•ã„',
              formRequirementsHelper: 'ä¾‹ï¼šæ¥½å™¨å¯ã€ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã‚ºãƒãƒ³ã‚·ãƒ§ãƒ³ã€ãƒªãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ç‰©ä»¶ãªã©',
              formSubmit: 'é€ä¿¡ã™ã‚‹',
              formSubmitting: 'é€ä¿¡ä¸­...',
              formSuccessMessage: 'ãŠå•ã„åˆã‚ã›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚2å–¶æ¥­æ—¥ä»¥å†…ã«ã”è¿”ä¿¡ã„ãŸã—ã¾ã™ã€‚',
              formErrorMessage: 'é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãŠæ‰‹æ•°ã§ã™ãŒã€ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚',
              fieldRequired: 'ã“ã®é …ç›®ã¯å¿…é ˆã§ã™',
              invalidEmail: 'æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'
            },
            footer: {
              copyright: 'Â© 2024 æ ªå¼ä¼šç¤¾ã‚¹ãƒãƒ¼ãƒˆã‚¢ã‚¤ã‚º All Rights Reserved.'
            }
          },
          zh: {
            rental: {
              pageTitle: 'ç§Ÿèµæˆ¿äº§å’¨è¯¢',
              pageSubtitle: 'è¯·å‘Šè¯‰æˆ‘ä»¬æ‚¨çš„éœ€æ±‚',
              formTitle: 'ç§Ÿèµæˆ¿äº§å’¨è¯¢è¡¨',
              formDescription: 'è¯·å¡«å†™ä»¥ä¸‹è¡¨æ ¼å¹¶ç‚¹å‡»æäº¤æŒ‰é’®ã€‚æˆ‘ä»¬å°†åœ¨2ä¸ªå·¥ä½œæ—¥å†…å›å¤æ‚¨ã€‚',
              formFullName: 'å§“å',
              formEmail: 'ç”µå­é‚®ç®±',
              formPhone: 'ç”µè¯å·ç ',
              formPropertyType: 'æˆ¿äº§ç±»å‹',
              formPropertyTypeSelect: 'è¯·é€‰æ‹©',
              formPropertyTypeApartment: 'å…¬å¯“',
              formPropertyTypeHouse: 'ç‹¬æ ‹æˆ¿å±‹',
              formPropertyTypeOffice: 'åŠå…¬å®¤',
              formPropertyTypeStore: 'åº—é“º',
              formPropertyTypeOther: 'å…¶ä»–',
              formBudget: 'é¢„ç®—ï¼ˆæœˆç§Ÿï¼‰',
              formBudgetSelect: 'è¯·é€‰æ‹©',
              formBudget50: '5ä¸‡æ—¥å…ƒä»¥ä¸‹',
              formBudget50to100: '5ä¸‡ï½10ä¸‡æ—¥å…ƒ',
              formBudget100to150: '10ä¸‡ï½15ä¸‡æ—¥å…ƒ',
              formBudget150to200: '15ä¸‡ï½20ä¸‡æ—¥å…ƒ',
              formBudget200to300: '20ä¸‡ï½30ä¸‡æ—¥å…ƒ',
              formBudget300: '30ä¸‡æ—¥å…ƒä»¥ä¸Š',
              formArea: 'å¸Œæœ›åŒºåŸŸ',
              formAreaSelect: 'è¯·é€‰æ‹©',
              formAreaShinjuku: 'æ–°å®¿åŒº',
              formAreaShibuya: 'æ¶©è°·åŒº',
              formAreaMinato: 'æ¸¯åŒº',
              formAreaChiyoda: 'åƒä»£ç”°åŒº',
              formAreaChuo: 'ä¸­å¤®åŒº',
              formAreaMeguro: 'ç›®é»’åŒº',
              formAreaSetagaya: 'ä¸–ç”°è°·åŒº',
              formAreaOtherTokyo: 'ä¸œäº¬å…¶ä»–23åŒº',
              formAreaOther: 'å…¶ä»–',
              formRooms: 'æˆ¿å‹',
              formRoomsSelect: 'è¯·é€‰æ‹©',
              formRooms1R: 'å•é—´',
              formRooms1K: '1K',
              formRooms1DK: '1DK',
              formRooms1LDK: '1LDK',
              formRooms2K: '2K',
              formRooms2DK: '2DK',
              formRooms2LDK: '2LDK',
              formRooms3LDK: '3LDKä»¥ä¸Š',
              formRoomsFlexible: 'å¯å•†è®®',
              formMoveInDate: 'å…¥ä½æ—¶é—´',
              formMoveInDateSelect: 'è¯·é€‰æ‹©',
              formMoveInImmediate: 'ç«‹å³',
              formMoveIn1Month: '1ä¸ªæœˆå†…',
              formMoveIn2Months: '2ä¸ªæœˆå†…',
              formMoveIn3Months: '3ä¸ªæœˆå†…',
              formMoveInFlexible: 'å¯å•†è®®',
              formLanguage: 'é¦–é€‰è¯­è¨€',
              formLanguageJa: 'æ—¥è¯­',
              formLanguageZh: 'ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰',
              formLanguageZhHant: 'ä¸­æ–‡ï¼ˆç¹ä½“ï¼‰',
              formLanguageEn: 'è‹±è¯­',
              formLanguageKo: 'éŸ©è¯­',
              formLanguageVi: 'è¶Šå—è¯­',
              formLanguageNe: 'å°¼æ³Šå°”è¯­',
              formTrainLine: 'æœ€è¿‘è½¦ç«™ï¼ˆç”µè½¦çº¿è·¯ï¼‰',
              formTrainLineSelect: 'è¯·é€‰æ‹©',
              formTrainLineYamanote: 'JRå±±æ‰‹çº¿',
              formTrainLineChuo: 'JRä¸­å¤®çº¿',
              formTrainLineSobu: 'JRæ€»æ­¦çº¿',
              formTrainLineKeio: 'äº¬ç‹çº¿',
              formTrainLineOdakyu: 'å°ç”°æ€¥çº¿',
              formTrainLineTokyu: 'ä¸œæ€¥ä¸œæ¨ªçº¿',
              formTrainLineSeibu: 'è¥¿æ­¦æ–°å®¿çº¿',
              formTrainLineMarunouchi: 'ä¸¸ä¹‹å†…çº¿',
              formTrainLineTozai: 'ä¸œè¥¿çº¿',
              formTrainLineGinza: 'é“¶åº§çº¿',
              formTrainLineFukutoshin: 'å‰¯éƒ½å¿ƒçº¿',
              formTrainLineOther: 'å…¶ä»–',
              formStationSelect: 'è¯·å…ˆé€‰æ‹©çº¿è·¯',
              formOtherTrainPlaceholder: 'è¯·è¾“å…¥å…¶ä»–çº¿è·¯/è½¦ç«™',
              formTrainHelper: 'å¦‚æœ‰å¸Œæœ›çš„æœ€è¿‘è½¦ç«™ï¼Œè¯·é€‰æ‹©çº¿è·¯å’Œè½¦ç«™',
              formConditions: 'æˆ¿äº§æ¡ä»¶',
              conditionBathToilet: 'æµ´å®¤å•æ‰€åˆ†ç¦»',
              conditionParking: 'åœè½¦åœº',
              conditionBikeParking: 'è‡ªè¡Œè½¦åœè½¦åœº',
              conditionSouthFacing: 'æœå—',
              conditionAutoLock: 'è‡ªåŠ¨é—¨é”',
              conditionSecondFloor: '2æ¥¼ä»¥ä¸Š',
              conditionPetFriendly: 'å…è®¸å® ç‰©',
              formConditionsHelper: 'å¦‚æœ‰å¸Œæœ›æ¡ä»¶è¯·é€‰æ‹©ï¼ˆå¯å¤šé€‰ï¼‰',
              formRequirements: 'å…¶ä»–è¦æ±‚',
              formRequirementsPlaceholder: 'å¦‚æœ‰å…¶ä»–è¦æ±‚è¯·å¡«å†™',
              formRequirementsHelper: 'ä¾‹å¦‚ï¼šå…è®¸ä¹å™¨ã€è®¾è®¡å¸ˆå…¬å¯“ã€ç¿»æ–°æˆ¿äº§ç­‰',
              formSubmit: 'æäº¤',
              formSubmitting: 'æäº¤ä¸­...',
              formSuccessMessage: 'æ„Ÿè°¢æ‚¨çš„å’¨è¯¢ã€‚æˆ‘ä»¬å°†åœ¨2ä¸ªå·¥ä½œæ—¥å†…å›å¤æ‚¨ã€‚',
              formErrorMessage: 'æäº¤å¤±è´¥ã€‚è¯·ç¨åé‡è¯•ã€‚',
              fieldRequired: 'æ­¤é¡¹ä¸ºå¿…å¡«',
              invalidEmail: 'è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€'
            },
            footer: {
              copyright: 'Â© 2024 æ ªå¼ä¼šç¤¾Smart Eyes ç‰ˆæƒæ‰€æœ‰'
            }
          },
          en: {
            rental: {
              pageTitle: 'Rental Property Inquiry',
              pageSubtitle: 'Tell us your requirements',
              formTitle: 'Rental Property Inquiry Form',
              formDescription: 'Please fill out the form below and click the submit button. We will reply within 2 business days.',
              formFullName: 'Full Name',
              formEmail: 'Email Address',
              formPhone: 'Phone Number',
              formPropertyType: 'Property Type',
              formPropertyTypeSelect: 'Please select',
              formPropertyTypeApartment: 'Apartment',
              formPropertyTypeHouse: 'House',
              formPropertyTypeOffice: 'Office',
              formPropertyTypeStore: 'Store',
              formPropertyTypeOther: 'Other',
              formBudget: 'Budget (Monthly)',
              formBudgetSelect: 'Please select',
              formBudget50: 'Under Â¥50,000',
              formBudget50to100: 'Â¥50,000 - Â¥100,000',
              formBudget100to150: 'Â¥100,000 - Â¥150,000',
              formBudget150to200: 'Â¥150,000 - Â¥200,000',
              formBudget200to300: 'Â¥200,000 - Â¥300,000',
              formBudget300: 'Over Â¥300,000',
              formArea: 'Preferred Area',
              formAreaSelect: 'Please select',
              formAreaShinjuku: 'Shinjuku',
              formAreaShibuya: 'Shibuya',
              formAreaMinato: 'Minato',
              formAreaChiyoda: 'Chiyoda',
              formAreaChuo: 'Chuo',
              formAreaMeguro: 'Meguro',
              formAreaSetagaya: 'Setagaya',
              formAreaOtherTokyo: 'Other Tokyo 23 Wards',
              formAreaOther: 'Other',
              formRooms: 'Layout',
              formRoomsSelect: 'Please select',
              formRooms1R: 'Studio',
              formRooms1K: '1K',
              formRooms1DK: '1DK',
              formRooms1LDK: '1LDK',
              formRooms2K: '2K',
              formRooms2DK: '2DK',
              formRooms2LDK: '2LDK',
              formRooms3LDK: '3LDK+',
              formRoomsFlexible: 'Flexible',
              formMoveInDate: 'Move-in Date',
              formMoveInDateSelect: 'Please select',
              formMoveInImmediate: 'Immediately',
              formMoveIn1Month: 'Within 1 month',
              formMoveIn2Months: 'Within 2 months',
              formMoveIn3Months: 'Within 3 months',
              formMoveInFlexible: 'Flexible',
              formLanguage: 'Preferred Language',
              formLanguageJa: 'Japanese',
              formLanguageZh: 'Chinese (Simplified)',
              formLanguageZhHant: 'Chinese (Traditional)',
              formLanguageEn: 'English',
              formLanguageKo: 'Korean',
              formLanguageVi: 'Vietnamese',
              formLanguageNe: 'Nepali',
              formTrainLine: 'Nearest Station (Train Line)',
              formTrainLineSelect: 'Please select',
              formTrainLineYamanote: 'JR Yamanote Line',
              formTrainLineChuo: 'JR Chuo Line',
              formTrainLineSobu: 'JR Sobu Line',
              formTrainLineKeio: 'Keio Line',
              formTrainLineOdakyu: 'Odakyu Line',
              formTrainLineTokyu: 'Tokyu Toyoko Line',
              formTrainLineSeibu: 'Seibu Shinjuku Line',
              formTrainLineMarunouchi: 'Marunouchi Line',
              formTrainLineTozai: 'Tozai Line',
              formTrainLineGinza: 'Ginza Line',
              formTrainLineFukutoshin: 'Fukutoshin Line',
              formTrainLineOther: 'Other',
              formStationSelect: 'Select line first',
              formOtherTrainPlaceholder: 'Please enter other line/station',
              formTrainHelper: 'If you have a preferred nearest station, please select the line and station',
              formConditions: 'Property Conditions',
              conditionBathToilet: 'Separate Bath/Toilet',
              conditionParking: 'Parking Available',
              conditionBikeParking: 'Bike Parking',
              conditionSouthFacing: 'South-facing',
              conditionAutoLock: 'Auto-lock',
              conditionSecondFloor: '2nd Floor or Above',
              conditionPetFriendly: 'Pet-friendly',
              formConditionsHelper: 'Select your preferred conditions (multiple selections allowed)',
              formRequirements: 'Other Requirements',
              formRequirementsPlaceholder: 'Please specify any other requirements',
              formRequirementsHelper: 'e.g., Musical instruments allowed, Designer apartment, Renovated property, etc.',
              formSubmit: 'Submit',
              formSubmitting: 'Submitting...',
              formSuccessMessage: 'Thank you for your inquiry. We will reply within 2 business days.',
              formErrorMessage: 'Submission failed. Please try again.',
              fieldRequired: 'This field is required',
              invalidEmail: 'Please enter a valid email address'
            },
            footer: {
              copyright: 'Â© 2024 Smart Eyes Co., Ltd. All Rights Reserved.'
            }
          }
        };
      }

      detectLanguage() {
        const urlParams = new URLSearchParams(window.location.search);
        const urlLang = urlParams.get('lang');
        if (urlLang && this.languages[urlLang]) {
          return urlLang;
        }

        try {
          const savedLang = localStorage.getItem('smarteyes_preferred_lang');
          if (savedLang && this.languages[savedLang]) {
            return savedLang;
          }
        } catch (e) {
          console.warn('Could not read from localStorage:', e);
        }

        const navLangs = navigator.languages || [navigator.language || navigator.userLanguage];
        for (const navLang of navLangs) {
          const code = navLang.toLowerCase();
          if (code.startsWith('zh-tw') || code.includes('hant')) return 'zh-Hant';
          if (code.startsWith('zh')) return 'zh';
          if (code.startsWith('ja')) return 'ja';
          if (code.startsWith('ko')) return 'ko';
          if (code.startsWith('vi')) return 'vi';
          if (code.startsWith('ne')) return 'ne';
          if (code.startsWith('en')) return 'en';
        }

        return this.fallbackLang;
      }

      getValue(path, data) {
        const keys = path.split('.');
        let value = data;
        for (const key of keys) {
          value = value && value[key];
          if (value === undefined) break;
        }
        return value;
      }

      applyLanguage(lang) {
        const data = this.translations[lang] || this.translations[this.fallbackLang];
        
        document.querySelectorAll('[data-i18n]').forEach(el => {
          const key = el.getAttribute('data-i18n');
          const value = this.getValue(key, data);
          if (value !== undefined) {
            if (el.tagName === 'INPUT' && el.type === 'submit') {
              el.value = value;
            } else if (el.tagName === 'OPTION') {
              el.textContent = value;
            } else if (el.hasAttribute('placeholder')) {
              el.placeholder = value;
            } else {
              el.innerHTML = value;
            }
          }
        });

        document.documentElement.lang = lang;
        
        try {
          localStorage.setItem('smarteyes_preferred_lang', lang);
        } catch (e) {
          console.warn('Could not save language preference:', e);
        }

        this.currentLang = lang;
        this.updateDropdown();
        
        console.log(`Language switched to: ${lang}`);
      }

      updateDropdown() {
        const currentButton = document.getElementById('langCurrent');
        const currentText = currentButton.querySelector('.lang-text');
        if (currentText) {
          currentText.textContent = this.languages[this.currentLang];
        }

        document.querySelectorAll('.lang-option').forEach(option => {
          const isActive = option.dataset.lang === this.currentLang;
          option.classList.toggle('active', isActive);
          const check = option.querySelector('.lang-check');
          if (check) {
            check.textContent = isActive ? 'âœ“' : '';
          }
        });
      }

      buildDropdown() {
        const currentButton = document.getElementById('langCurrent');
        const menu = document.getElementById('langMenu');
        
        Object.entries(this.languages).forEach(([code, name]) => {
          const option = document.createElement('button');
          option.className = 'lang-option';
          option.dataset.lang = code;
          option.setAttribute('role', 'menuitem');
          option.innerHTML = `
            <span class="lang-check"></span>
            <span>${name}</span>
          `;
          
          option.addEventListener('click', () => {
            this.applyLanguage(code);
            this.hideDropdown();
          });
          
          menu.appendChild(option);
        });

        currentButton.addEventListener('click', (e) => {
          e.stopPropagation();
          this.toggleDropdown();
        });

        document.addEventListener('click', () => {
          this.hideDropdown();
        });
      }

      toggleDropdown() {
        const menu = document.getElementById('langMenu');
        const isShown = menu.classList.contains('show');
        if (isShown) {
          this.hideDropdown();
        } else {
          this.showDropdown();
        }
      }

      showDropdown() {
        const currentButton = document.getElementById('langCurrent');
        const menu = document.getElementById('langMenu');
        
        currentButton.setAttribute('aria-expanded', 'true');
        menu.classList.add('show');
      }

      hideDropdown() {
        const currentButton = document.getElementById('langCurrent');
        const menu = document.getElementById('langMenu');
        
        currentButton.setAttribute('aria-expanded', 'false');
        menu.classList.remove('show');
      }
    }

    // ===== Performance Optimization =====
    function optimizePerformance() {
      function throttle(func, limit) {
        let inThrottle;
        return function() {
          const args = arguments;
          const context = this;
          if (!inThrottle) {
            func.apply(context, args);
            inThrottle = true;
            setTimeout(() => inThrottle = false, limit);
          }
        };
      }
      
      const handleScroll = throttle(() => {
        const header = document.querySelector('.site-header');
        if (window.scrollY > 100) {
          header.style.background = 'rgba(255,255,255,0.98)';
          header.style.boxShadow = '0 4px 20px rgba(30, 64, 175, 0.1)';
        } else {
          header.style.background = 'rgba(255,255,255,0.95)';
          header.style.boxShadow = 'none';
        }
      }, 16);
      
      window.addEventListener('scroll', handleScroll, { passive: true });
    }

    // ===== Main Initialization =====
    const i18n = new I18nManager();
    const rentalForm = new RentalFormManager();

    function init() {
      i18n.buildDropdown();
      
      const detectedLang = i18n.detectLanguage();
      i18n.applyLanguage(detectedLang);
      
      optimizePerformance();
      
      console.log('Smart Eyes rental form initialized successfully');
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  </script>
</body>
</html>
